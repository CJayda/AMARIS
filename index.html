<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMARIS | Private Sanctuary</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --primary: #475569; --accent: #1e293b; --glass: rgba(255, 255, 255, 0.95);
            --text-dark: #000000; --strength-col: #ef4444;
        }

        /* THEME OPTIMIZATION */
        .theme-obsidian { 
            --primary: #1e293b; --accent: #0f172a; 
            --glass: rgba(220, 227, 235, 0.98); /* Light grey glass */
            --text-dark: #020617; /* Solid ink black text */
        }
        .theme-male { --primary: #334155; --glass: rgba(241, 245, 249, 0.96); --text-dark: #0f172a; }
        .theme-female { --primary: #b5838d; --glass: rgba(255, 245, 245, 0.96); --text-dark: #432818; }

        body, html { margin: 0; padding: 0; min-height: 100vh; font-family: 'Inter', sans-serif; background-color: #0f172a; color: var(--text-dark); overflow-x: hidden; }
        
        #bg-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background-image: linear-gradient(rgba(15, 23, 42, 0.8), rgba(15, 23, 42, 0.8)), url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%25' height='100%25'%3E%3Cpattern id='p' width='50' height='50' patternUnits='userSpaceOnUse'%3E%3Ccircle cx='25' cy='25' r='1' fill='%23ffffff' fill-opacity='0.2'/%3E%3C/pattern%3E%3Crect width='100%25' height='100%25' fill='url(%23p)'/%3E%3C/svg%3E");
            background-size: cover;
        }

        #auth-screen, #main-app { min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; }
        #main-app { display: none; flex-direction: column; gap: 30px; }

        .glass-card { 
            background: var(--glass); backdrop-filter: blur(25px); padding: 40px; border-radius: 35px; 
            box-shadow: 0 40px 80px rgba(0,0,0,0.5); width: 100%; max-width: 500px; text-align: center;
            border: 1px solid rgba(255,255,255,0.4);
        }

        h1 { font-family: 'Playfair Display', serif; color: var(--text-dark); margin: 0; text-transform: uppercase; letter-spacing: 4px; }
        .tagline { font-size: 0.7rem; letter-spacing: 5px; text-transform: uppercase; margin: 10px 0 25px; display: block; color: var(--primary); font-weight: 700; }

        input, select, textarea { 
            width: 100%; padding: 15px; margin: 10px 0; border: none; border-bottom: 2px solid var(--primary); 
            background: rgba(0,0,0,0.03); color: var(--text-dark); outline: none; font-weight: 600;
        }

        button { 
            padding: 14px 24px; border-radius: 10px; border: none; background: var(--accent); 
            color: white; cursor: pointer; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; transition: 0.2s;
        }
        button:hover { opacity: 0.9; transform: scale(1.02); }

        .note-item { 
            background: var(--glass); padding: 30px; border-radius: 25px; margin-bottom: 20px; 
            border-left: 10px solid var(--accent); text-align: left;
        }
        .note-item p { font-size: 1.1rem; line-height: 1.6; font-weight: 500; color: var(--text-dark); }
        .media-preview { width: 100%; border-radius: 15px; margin-top: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

        /* PASSWORD TOOLS */
        .pass-container { position: relative; width: 100%; }
        .peek-btn { position: absolute; right: 15px; top: 18px; cursor: pointer; font-size: 0.65rem; font-weight: 900; color: var(--text-dark); }
        #strength-meter { height: 5px; width: 0%; transition: 0.5s; margin-top: -8px; margin-bottom: 15px; border-radius: 5px; }

        #breath-overlay { display: none; position: fixed; inset: 0; background: rgba(2, 6, 23, 0.98); z-index: 2000; flex-direction: column; justify-content: center; align-items: center; color: white; }
        .breath-circle { width: 120px; height: 120px; border: 4px solid white; border-radius: 50%; animation: breathe 8s infinite ease-in-out; }
        @keyframes breathe { 0%, 100% { transform: scale(1); opacity: 0.3; } 50% { transform: scale(2.2); opacity: 1; } }

        @media print { .no-print { display: none !important; } }
    </style>
</head>
<body onload="initApp()">

    <div id="bg-layer"></div>

    <div id="breath-overlay" onclick="this.style.display='none'">
        <div class="breath-circle"></div>
        <h2 id="breath-txt" style="margin-top:40px; letter-spacing:4px;">INHALING...</h2>
    </div>

    <div id="auth-screen">
        <div class="glass-card">
            <h1>Amaris</h1>
            <span class="tagline">By Chantel Jayda</span>
            
            <input type="text" id="user" placeholder="USERNAME" autocomplete="off">
            
            <div class="pass-container">
                <input type="password" id="pass" placeholder="PASSWORD" oninput="checkPass(this.value)">
                <span class="peek-btn" onclick="togglePeek()">PEEK</span>
            </div>
            <div id="strength-meter"></div>
            
            <div id="reg-fields" style="display:none;">
                <input type="text" id="hint" placeholder="PASSWORD HINT (e.g. My dog's name)">
                <select id="aesthetic">
                    <option value="" disabled selected>CHOOSE AESTHETIC</option>
                    <option value="obsidian">OBSIDIAN</option>
                    <option value="male">GENTLEMAN</option>
                    <option value="female">LADY</option>
                </select>
            </div>
            
            <button onclick="auth()" id="auth-btn" style="width:100%">Step Inside</button>
            
            <div id="forgot-link" style="margin-top: 20px;">
                <p onclick="showHint()" style="cursor:pointer; font-size:0.7rem; color:var(--text-dark); font-weight:700;">FORGOT PASSWORD?</p>
                <p onclick="toggleReg()" style="cursor:pointer; font-size:0.7rem; color:var(--text-dark); font-weight:700; margin-top:10px;">+ CREATE PROFILE</p>
            </div>
        </div>
    </div>

    <div id="main-app">
        <div class="glass-card" style="max-width:750px; text-align:left;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h2 id="welcome-msg" style="margin:0; font-family:'Playfair Display'; color: var(--text-dark);">Sanctuary</h2>
                <div class="no-print">
                    <button onclick="document.getElementById('breath-overlay').style.display='flex'">üßò BREATHE</button>
                    <button onclick="window.print()" style="background:#475569;">üìÑ EXPORT</button>
                </div>
            </div>
            <textarea id="note-input" placeholder="What's your story today?" style="margin-top:20px;"></textarea>
            <div style="display:flex; gap:10px;">
                <button onclick="document.getElementById('media-input').click()" style="background:#94a3b8;">üñºÔ∏è ADD MEDIA</button>
                <input type="file" id="media-input" hidden accept="image/*,video/*">
                <button onclick="save()" style="flex-grow:1;">ARCHIVE</button>
            </div>
            <div id="status" style="font-size:0.75rem; font-weight:bold; margin-top:5px;"></div>
        </div>
        <div id="feed" style="width:100%; max-width:750px;"></div>
    </div>

    <script>
        let currentMedia = null;

        function initApp() {
            setInterval(() => {
                const t = document.getElementById('breath-txt');
                t.innerText = t.innerText === "INHALING..." ? "EXHALING..." : "INHALING...";
            }, 4000);
        }

        function togglePeek() {
            const p = document.getElementById('pass');
            p.type = p.type === 'password' ? 'text' : 'password';
        }

        function checkPass(v) {
            const m = document.getElementById('strength-meter');
            let s = v.length * 10;
            m.style.width = Math.min(s, 100) + "%";
            m.style.background = s < 40 ? "#ef4444" : s < 70 ? "#eab308" : "#22c55e";
        }

        function toggleReg() {
            document.getElementById('reg-fields').style.display = 'block';
            document.getElementById('auth-btn').innerText = 'CREATE PROFILE';
        }

        function showHint() {
            const u = document.getElementById('user').value.toLowerCase().trim();
            if(!u) return alert("Enter your username first");
            const d = JSON.parse(localStorage.getItem(u));
            if(d && d.h) alert("Your Hint: " + d.h); else alert("No hint found.");
        }

        document.getElementById('media-input').onchange = e => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = () => {
                currentMedia = { data: reader.result, type: file.type.startsWith('image') ? 'img' : 'video' };
                document.getElementById('status').innerText = "‚úì Media Ready";
            };
            reader.readAsDataURL(file);
        };

        function auth() {
            const u = document.getElementById('user').value.toLowerCase().trim();
            const p = document.getElementById('pass').value;
            if(!u || !p) return;

            if(document.getElementById('auth-btn').innerText === 'STEP INSIDE') {
                const d = JSON.parse(localStorage.getItem(u));
                if(d && d.p === p) launch(u, d); else alert("Access Denied");
            } else {
                const a = document.getElementById('aesthetic').value;
                const h = document.getElementById('hint').value;
                if(!a) return alert("Pick a theme");
                const d = { p, a, h, n: [] };
                localStorage.setItem(u, JSON.stringify(d));
                launch(u, d);
            }
        }

        function launch(u, d) {
            document.body.className = 'theme-' + d.a;
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'flex';
            document.getElementById('welcome-msg').innerText = "Welcome, " + u;
            render(u);
        }

        function save() {
            const u = document.getElementById('welcome-msg').innerText.replace("Welcome, ", "");
            const t = document.getElementById('note-input').value;
            if(!t && !currentMedia) return;
            const d = JSON.parse(localStorage.getItem(u));
            d.n.unshift({ t, media: currentMedia, date: new Date().toLocaleString(), id: Date.now() });
            localStorage.setItem(u, JSON.stringify(d));
            currentMedia = null; document.getElementById('note-input').value = ""; 
            document.getElementById('status').innerText = ""; render(u);
        }

        function render(u) {
            const d = JSON.parse(localStorage.getItem(u));
            const f = document.getElementById('feed');
            f.innerHTML = "";
            d.n.forEach(note => {
                let m = "";
                if(note.media) {
                    m = note.media.type === 'img' ? `<img src="${note.media.data}" class="media-preview">` : `<video controls src="${note.media.data}" class="media-preview"></video>`;
                }
                f.innerHTML += `
                    <div class="note-item">
                        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                            <small style="font-weight:700; opacity:0.6;">${note.date}</small>
                            <span class="no-print" onclick="del('${u}', ${note.id})" style="color:#ef4444; cursor:pointer; font-weight:900; font-size:0.7rem;">DELETE</span>
                        </div>
                        <p contenteditable="true" onblur="upd('${u}', ${note.id}, this.innerText)">${note.t}</p>
                        ${m}
                    </div>`;
            });
        }

        function upd(u, id, text) {
            const d = JSON.parse(localStorage.getItem(u));
            d.n.find(x => x.id === id).t = text;
            localStorage.setItem(u, JSON.stringify(d));
        }

        function del(u, id) {
            if(confirm("Permanently delete?")) {
                const d = JSON.parse(localStorage.getItem(u));
                d.n = d.n.filter(x => x.id !== id);
                localStorage.setItem(u, JSON.stringify(d));
                render(u);
            }
        }
    </script>
</body>
</html>
